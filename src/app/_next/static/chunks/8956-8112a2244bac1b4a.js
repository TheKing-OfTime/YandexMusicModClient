(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8956],{18956:function(e,t,i){"use strict";i.d(t,{MusicHistoryPage:function(){return I}});var a=i(65301),r=i(9695),s=i(96233),n=i(91207),o=i(44729),l=i(55975),c=i(46642),d=i(77670),u=i(81437),m=i(61492),v=i(36643),h=i(58997),x=i(29778),y=i(51304);let p=e=>{let{children:t}=e,i=(0,n.useRef)({}),r=(0,n.useMemo)(()=>(0,y.wE)(e=>{var t,a;let r=(0,y.SG)(e.target),s=i.current[r];e.isIntersecting?null==s||null===(t=s.onShow)||void 0===t||t.call(s):null==s||null===(a=s.onHide)||void 0===a||a.call(s)}),[]);(0,n.useEffect)(()=>()=>null==r?void 0:r.disconnect(),[r]);let s=(0,n.useCallback)(e=>{!i.current[e.elementId]&&e.elementRef.current&&(null==r||r.observe(e.elementRef.current),i.current[e.elementId]=e)},[r]),o=(0,n.useCallback)(e=>{let t=i.current[e];t&&t.elementRef.current&&(null==r||r.unobserve(t.elementRef.current))},[r]),l=(0,n.useMemo)(()=>({observeElement:s,unobserveElement:o}),[s,o]);return(0,a.jsx)(m.ee.Provider,{value:l,children:t})},b=async(e,t)=>new Promise(i=>{if("onscrollend"in window){var a;let r=()=>{var e;i(),null===(e=t.current)||void 0===e||e.removeEventListener("scrollend",r)};null===(a=t.current)||void 0===a||a.addEventListener("scrollend",r),e.scrollIntoView({behavior:"smooth"})}else e.scrollIntoView({behavior:"smooth"}),window.setTimeout(i,1e3)});var S=i(59058),g=i.n(S),_=i(82607),k=i(56403),f=i.n(k);let j=e=>{let{isActive:t}=e,i=(0,a.jsxs)("div",{className:f().trackListShimmers,children:[(0,a.jsx)(x.DX,{isActive:t,variant:h.Lxt.PLAYLIST}),(0,a.jsx)(x.DX,{isActive:t,variant:h.Lxt.PLAYLIST}),(0,a.jsx)(x.DX,{isActive:t,variant:h.Lxt.PLAYLIST})]});return(0,a.jsxs)("div",{className:f().shimmersContainer,children:[(0,a.jsx)(_.Shimmer,{isActive:t,className:f().dateShimmer}),(0,a.jsx)(_.Shimmer,{isActive:t,className:f().contextNameShimmer}),(0,a.jsx)(x.XM,{withDescription:!0,className:f().contextHeaderShimmer}),i,(0,a.jsx)(_.Shimmer,{isActive:t,className:f().contextNameShimmer}),(0,a.jsx)(x.XM,{coverRadius:"round",className:f().contextHeaderShimmer}),i]})},I=(0,s.Pi)(()=>{let[e,t]=(0,n.useState)(!1),{musicHistory:i}=(0,h.oR4)(),{contentScrollRef:s,setContentScrollRef:y}=(0,h.$Y6)(),S=(0,d.useTabsState)(0),_=(0,n.useRef)(!1),k=(0,n.useRef)(null),f=(0,n.useCallback)(async e=>{var a;t(!0);let r=i.dates[e];if(!r)return;null===(a=S.onTabChange)||void 0===a||a.call(S,e),_.current=!0;let n=document.querySelector('[data-date-anchor="'.concat(r,'"]'));n&&(k.current=s,await b(n,k)),_.current=!1},[i.dates,S,s]);i.loadingState===h.Gui.IDLE&&(0,n.use)(i.getMusicHistory());let I=(0,n.useCallback)(()=>{if(_.current)return;let e=i.dates.findIndex(e=>i.datesMap.get(e));if(e>=0){var t;null===(t=S.onTabChange)||void 0===t||t.call(S,e)}},[i.dates,i.datesMap,S]);(0,n.useEffect)(()=>()=>i.reset(),[i]),(0,h.NOh)(i.loadingState===h.Gui.RESOLVE);let M=(0,n.useMemo)(()=>{var t;return i.isRejected?(0,a.jsx)(v.D,{className:(0,r.W)(g().error,g().important),withBackwardControl:!1}):i.isShimmerVisible?(0,a.jsx)(j,{isActive:i.isShimmerActive}):i.isEmpty?(0,a.jsx)("div",{className:g().empty,children:(0,a.jsx)(u.Caption,{variant:"div",size:"m",weight:"normal",children:(0,a.jsx)(o.Z,{id:"music-history.empty-title"})})}):null===(t=i.tabs)||void 0===t?void 0:t.map((t,i)=>(0,a.jsx)(m.Wb,{onTabShowOrHide:I,"data-intersection-property-id":t.date,tab:t,tabIndex:i,shouldHideInactiveTab:e},i))},[I,i.isEmpty,i.isRejected,i.isShimmerActive,i.isShimmerVisible,i.tabs,e]),E=(0,m.e8)(),A=(0,n.useMemo)(()=>(0,a.jsx)(x.no,{isShimmerVisible:i.isShimmerVisible,className:g().tabs,...S,onTabChange:f,shimmer:(0,a.jsx)(x.tS,{className:g().tabs,shimmerClassName:(0,r.W)(g().tab,{[g().tab_isLoading]:i.isShimmerVisible}),count:5}),children:i.dates.map((e,t)=>(0,a.jsx)(x.OK,{className:(0,r.W)(g().tab,{[g().tab_selected]:t===S.value}),titleClassName:g().date,"aria-label":E(e,!1),title:E(e,!1),value:t},t))}),[E,f,i.dates,i.isShimmerVisible,S]);return(0,a.jsx)(h.Lh6,{pageId:h.Rhz.HISTORY,children:(0,a.jsxs)("div",{className:g().root,...(0,l.BA)(l.Br.musicHistory.MUSIC_HISTORY_PAGE),children:[(0,a.jsxs)("div",{className:g().headerContainer,children:[(0,a.jsxs)("div",{className:g().header,children:[(0,a.jsx)(x.nP,{withForwardControl:!1}),(0,a.jsx)(u.Heading,{variant:"h1",weight:"bold",size:"xl",lineClamp:1,children:(0,a.jsx)(o.Z,{id:"music-history.title"})})]}),(0,a.jsx)(x.J3,{className:g().carousel,carouselElement:A})]}),(0,a.jsxs)(c.t,{ref:y,className:g().scroll,containerClassName:g().scrollContainer,children:[(0,a.jsx)(p,{children:(0,a.jsx)("div",{className:g().content,children:M})}),(0,a.jsx)(x.$_,{className:g().footer})]})]})})})},61492:function(e,t,i){"use strict";i.d(t,{ee:function(){return j.MusicHistoryIntersectionObserverContext},Mf:function(){return O},Wb:function(){return B.MusicHistoryTab},t9:function(){return U},un:function(){return a},H5:function(){return r},aQ:function(){return s},LV:function(){return n},R3:function(){return o},Ql:function(){return I},DF:function(){return M},v3:function(){return E},eE:function(){return A},OE:function(){return f},e8:function(){return C.useFormatDate}});let a=e=>e.data.itemId.id,r=e=>e.data.itemId.id,s=e=>{let{uid:t,kind:i}=e.data.itemId;return"".concat(t,":").concat(i)},n=e=>{let{albumId:t,trackId:i}=e.data.itemId;return t?"".concat(i,":").concat(t):i},o=e=>e.data.itemId.seeds.sort().join(",");var l=i(2685),c=i(9973),d=i(54709),u=i(58997),m=i(3154);let v=e=>{if("fullModel"in e.data){let{fullModel:t}=e.data;return(0,l.pj)({type:c.E.TRACK,id:n(e),loadingState:u.Gui.RESOLVE,data:(0,m.Vt)(t)})}return(0,l.pj)({type:c.E.TRACK,id:n(e),data:null,loadingState:u.Gui.IDLE})},h=(e,t)=>{let{data:i}=e;if("fullModel"in i){let{fullModel:r}=i;return(0,l.pj)({type:c.E.ALBUM,available:r.available,id:a(e),meta:(0,d.cO)({album:r.album,artists:r.artists}),loadingState:u.Gui.RESOLVE,tracks:t.map(v)})}return(0,l.pj)({type:c.E.ALBUM,available:!0,id:a(e),meta:null,loadingState:u.Gui.IDLE,tracks:t.map(v)})};var x=i(9096);let y=(e,t)=>{let{data:i,type:a}=e;if("fullModel"in i){let{fullModel:s}=i;return(0,l.pj)({type:a,available:s.available,id:r(e),meta:(0,x.tR)({artist:s.artist}),loadingState:u.Gui.RESOLVE,tracks:t.map(v)})}return(0,l.pj)({type:a,available:!0,id:r(e),meta:null,loadingState:u.Gui.IDLE,tracks:t.map(v)})};var p=i(10231);let b=(e,t)=>{let{type:i}=e;return(0,l.pj)({type:i,id:(0,p.Z)(),tracks:t.map(v)})};var S=i(81706);let g=(e,t)=>{let{data:i,type:a}=e;if("fullModel"in i){let{fullModel:r}=i;return(0,l.pj)({type:a,id:s(e),meta:{...(0,S.RE)({playlist:r.playlist}),tracksCount:r.tracksCount},loadingState:u.Gui.RESOLVE,tracks:t.map(v)})}return(0,l.pj)({type:c.E.PLAYLIST,id:s(e),meta:null,loadingState:u.Gui.IDLE,tracks:t.map(v)})};var _=i(90741);let k=(e,t)=>{let{data:i,type:a}=e;if("fullModel"in i){let{fullModel:r}=i;return(0,l.pj)({type:a,id:o(e),meta:{...(0,_.FF)(r.wave),imageUrl:r.simpleWaveForegroundImageUrl,backgroundColor:r.simpleWaveBackgroundColor},loadingState:u.Gui.RESOLVE,tracks:t.map(v)})}return(0,l.pj)({type:a,id:o(e),meta:null,loadingState:u.Gui.IDLE,tracks:t.map(v)})},f=e=>{var t,i;let a=null===(t=e.items)||void 0===t?void 0:t.map(e=>{switch(e.context.type){case c.E.ALBUM:return h(e.context,e.tracks);case c.E.PLAYLIST:return g(e.context,e.tracks);case c.E.ARTIST:return y(e.context,e.tracks);case c.E.WAVE:return k(e.context,e.tracks);case c.E.SEARCH:case c.E.OTHER:return b(e.context,e.tracks);default:return null}}).filter(e=>e);return{date:e.date,blocks:null!==(i=(0,l.pj)(a))&&void 0!==i?i:null}};var j=i(27821);let I=e=>(null==e?void 0:e.type)===c.E.ALBUM,M=e=>(null==e?void 0:e.type)===c.E.ARTIST,E=e=>(null==e?void 0:e.type)===c.E.PLAYLIST,A=e=>(null==e?void 0:e.type)===c.E.WAVE;var C=i(84705),V=i(86348);let H=e=>({type:V.RX.Unloaded,meta:{id:e.entityId}}),L=l.V5.model("MusicHistoryTrack",{type:l.V5.literal(c.E.TRACK),id:l.V5.string,data:l.V5.maybeNull(m.le),loadingState:l.V5.enumeration(Object.values(u.Gui))}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get isNeededToLoad(){return e.loadingState===u.Gui.IDLE},get isLoading(){return e.loadingState===u.Gui.PENDING},get isRejected(){return e.loadingState===u.Gui.REJECT},get isShimmerVisible(){return this.isNeededToLoad||this.isLoading||this.isRejected},get isShimmerActive(){return this.isLoading},get entityId(){var t;if(!e.data)return e.id;let{id:i,albums:a}=e.data,r=null===(t=a[0])||void 0===t?void 0:t.id;return r?"".concat(i,":").concat(r):i}})).named("MusicHistoryPlaylist"),N=l.V5.model("MusicHistoryBaseBlock",{id:l.V5.string,loadingState:l.V5.enumeration(Object.values(u.Gui)),tracks:l.V5.array(L)}).views(e=>({get isNeededToLoad(){return e.loadingState===u.Gui.IDLE},get isLoading(){return e.loadingState===u.Gui.PENDING},get isLoaded(){return e.loadingState===u.Gui.RESOLVE},get isRejected(){return e.loadingState===u.Gui.REJECT},get isShimmerVisible(){return this.isNeededToLoad||this.isLoading||this.isRejected},get isShimmerActive(){return this.isLoading},get contextId(){return e.id},get entitiesData(){return e.tracks.map(H)}})),T=N.props({type:l.V5.literal(c.E.ALBUM),available:l.V5.boolean,meta:l.V5.maybeNull(d.ug)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["album:".concat(null===(t=e.meta)||void 0===t?void 0:t.id)]}})).named("MusicHistoryAlbum"),P=N.props({type:l.V5.literal(c.E.ARTIST),available:l.V5.boolean,meta:l.V5.maybeNull(x.Go)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["artist:".concat(null===(t=e.meta)||void 0===t?void 0:t.id)]}})).named("MusicHistoryArtist"),R=l.V5.model("MusicHistoryCommon",{id:l.V5.string,type:l.V5.union(l.V5.literal(c.E.OTHER),l.V5.literal(c.E.SEARCH)),tracks:l.V5.array(L)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){return e.tracks.map(e=>e.id).join(",")},get entitiesData(){return e.tracks.map(H)}})),w=N.props({type:l.V5.literal(c.E.PLAYLIST),meta:l.V5.maybeNull(S.d2)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t,i;return["playlist:".concat(null===(t=e.meta)||void 0===t?void 0:t.uid,"_").concat(null===(i=e.meta)||void 0===i?void 0:i.kind)]}})).named("MusicHistoryPlaylist"),D=N.props({id:l.V5.string,type:l.V5.literal(c.E.WAVE),meta:l.V5.maybeNull(_.KW)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){var t,i;return null!==(i=null===(t=e.meta)||void 0===t?void 0:t.stationId)&&void 0!==i?i:u.sHr},get autoflowSeeds(){var a;return null===(a=e.meta)||void 0===a?void 0:a.seeds}})),G=l.V5.union(T,P,w,D,R),O=l.V5.model({id:l.V5.string,type:l.V5.enumeration(Object.values(c.E)),tabIndex:l.V5.number,blockIndex:l.V5.number,trackIndex:l.V5.maybeNull(l.V5.number),loadingState:l.V5.enumeration(Object.values(u.Gui))}).views(e=>({get isLoaded(){return e.loadingState===u.Gui.RESOLVE}})),U=l.V5.model("MusicHistoryTab",{date:l.V5.string,blocks:l.V5.maybeNull(l.V5.array(G))});var B=i(52840)},27821:function(e,t,i){"use strict";i.d(t,{MusicHistoryIntersectionObserverContext:function(){return a}});let a=(0,i(91207).createContext)({observeElement:()=>{},unobserveElement:()=>{}})},84705:function(e,t,i){"use strict";i.d(t,{useFormatDate:function(){return s}});var a=i(91207),r=i(37184);let s=()=>{let{formatDate:e,formatRelativeTime:t}=(0,r.Z)();return(0,a.useCallback)(function(i){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=new Date(i),s=new Date;r.setHours(0,0,0,0),s.setHours(0,0,0,0);let n=(r.getTime()-s.getTime())/864e5,o=t(n,"day",{numeric:"auto"}),l=e(i,{day:"numeric",month:"long"});switch(n){case 0:case -1:case -2:if(a)return"".concat(o,", ").concat(l);return o;default:return l}},[e,t])}},52840:function(e,t,i){"use strict";i.d(t,{MusicHistoryTab:function(){return L}});var a=i(65301),r=i(96233),s=i(91207),n=i(9973),o=i(81437),l=i(58997),c=i(27821),d=i(84705),u=i(9695),m=i(44729),v=i(19489),h=i(69847),x=i(9096),y=i(29778);let p=e=>{let{id:t,tabIndex:i,blockIndex:a,trackIndex:r}=e,{musicHistory:n}=(0,l.oR4)(),o=(0,s.useId)(),d=(0,s.useRef)(null),{observeElement:u,unobserveElement:m}=(0,s.useContext)(c.MusicHistoryIntersectionObserverContext);return(0,s.useEffect)(()=>{let e=void 0!==r?"".concat(i,"_").concat(a,"_").concat(r,"_").concat(t):"".concat(i,"_").concat(a,"_").concat(t),s=n.indexesMap.get(e);n.isInObservationRange(s)&&u({elementRef:d,elementId:o,index:s,onShow(){n.getItems(this.index),m(o)}})},[a,t,o,n,u,i,r,m]),{intersectionPropertyId:o,ref:d}};var b=i(3154),S=i(55913),g=i.n(S);let _=(0,r.Pi)(e=>{let{type:t,track:i,artists:r,tabIndex:s,blockIndex:n,trackIndex:o,playContextParams:c}=e,{ref:d,intersectionPropertyId:u}=p({id:i.id,tabIndex:s,blockIndex:n,trackIndex:o});return i.isShimmerVisible||!i.data?(0,a.jsx)("div",{"data-intersection-property-id":u,ref:d,children:(0,a.jsx)(y.DX,{isActive:i.isShimmerActive,"data-intersection-property-id":u,className:g().trackShimmer,variant:t===v.A.Album?l.Lxt.ALBUM:l.Lxt.PLAYLIST})}):t===v.A.Album?(0,a.jsx)(b.RJ,{track:i.data,position:i.data.index,albumArtists:r,playContextParams:c}):(0,a.jsx)(b.O2,{track:i.data,playContextParams:c})});var k=i(83141),f=i.n(k);let j=(0,r.Pi)(e=>{var t,i,r,n;let{album:c,tabIndex:d,blockIndex:b}=e,{ref:S,intersectionPropertyId:g}=p({id:c.id,tabIndex:d,blockIndex:b}),{from:k}=(0,l.MhG)({blockId:"album-".concat(c.id)}),j=(0,s.useMemo)(()=>{var e,t;return c.available?(0,a.jsx)(x.jO,{className:f().artists,linkClassName:f().artistLink,artists:null===(e=c.meta)||void 0===e?void 0:e.artists,lineClamp:1}):null===(t=c.meta)||void 0===t?void 0:t.artistNames},[c.available,null===(t=c.meta)||void 0===t?void 0:t.artistNames,null===(i=c.meta)||void 0===i?void 0:i.artists]),I=(0,s.useMemo)(()=>{var e,t;return c.isShimmerVisible?(0,a.jsx)(y.XM,{isActive:c.isShimmerActive,className:f().header,withDescription:!0}):(0,a.jsx)(y.ti,{className:f().header,coverUrl:null===(e=c.meta)||void 0===e?void 0:e.coverUri,title:null===(t=c.meta)||void 0===t?void 0:t.title,titleSize:"xs",titleLineClamp:1,description:j,titleClassName:f().headerTitle,viewAllActionLink:"/album/".concat(c.id),available:c.available,fallbackIconVariant:"album",withCover:!0,headingVariant:"h4"})},[c.available,c.id,c.isShimmerActive,c.isShimmerVisible,null===(r=c.meta)||void 0===r?void 0:r.coverUri,null===(n=c.meta)||void 0===n?void 0:n.title,j]),M=(0,s.useMemo)(()=>c.tracks.map((e,t)=>{let i={contextData:{type:v.A.Various,meta:{id:c.contextId},from:k,overrideContextType:h.Z.Album,overrideAutoflowSeeds:c.autoflowSeeds},queueParams:{index:t},loadContextMeta:!1,entitiesData:c.entitiesData};return(0,a.jsx)(_,{type:v.A.Album,track:e,playContextParams:i,tabIndex:d,blockIndex:b,trackIndex:t},"".concat(e.key,"_").concat(t))}),[c.tracks,c.contextId,c.autoflowSeeds,c.entitiesData,k,d,b]);return(0,a.jsxs)("section",{className:f().root,ref:S,"data-intersection-property-id":g,children:[(0,a.jsx)(o.Heading,{className:(0,u.W)(f().header,f().heading),variant:"h3",children:(0,a.jsx)(m.Z,{id:"music-history.album"})}),I,(0,a.jsx)("div",{className:f().content,children:M})]})}),I=(0,r.Pi)(e=>{var t,i;let{artist:r,tabIndex:n,blockIndex:c}=e,{ref:d,intersectionPropertyId:x}=p({id:r.id,tabIndex:n,blockIndex:c}),{from:b}=(0,l.MhG)({blockId:"artist-".concat(r.id)}),S=(0,s.useMemo)(()=>{var e,t;return r.isShimmerVisible?(0,a.jsx)(y.XM,{isActive:r.isShimmerActive,className:f().header,coverRadius:"round"}):(0,a.jsx)(y.ti,{titleSize:"xs",titleLineClamp:1,className:f().header,coverUrl:null===(e=r.meta)||void 0===e?void 0:e.coverUri,title:null===(t=r.meta)||void 0===t?void 0:t.name,titleClassName:f().headerTitle,viewAllActionLink:"/artist/".concat(r.id),available:r.available,withCover:!0,coverRadius:"round",headingVariant:"h4"})},[r.available,r.id,r.isShimmerActive,r.isShimmerVisible,null===(t=r.meta)||void 0===t?void 0:t.coverUri,null===(i=r.meta)||void 0===i?void 0:i.name]),g=(0,s.useMemo)(()=>r.tracks.map((e,t)=>{let i={contextData:{type:v.A.Various,meta:{id:r.contextId},from:b,overrideAutoflowSeeds:r.autoflowSeeds,overrideContextType:h.Z.Artist},queueParams:{index:t},loadContextMeta:!1,entitiesData:r.entitiesData};return(0,a.jsx)(_,{type:v.A.Artist,track:e,playContextParams:i,tabIndex:n,blockIndex:c,trackIndex:t},"".concat(e.id,"_").concat(t))}),[r.tracks,r.contextId,r.autoflowSeeds,r.entitiesData,b,n,c]);return(0,a.jsxs)("section",{className:f().root,ref:d,"data-intersection-property-id":x,children:[(0,a.jsx)(o.Heading,{className:(0,u.W)(f().header,f().heading),variant:"h3",children:(0,a.jsx)(m.Z,{id:"music-history.artist"})}),S,(0,a.jsx)("div",{className:f().content,children:g})]})}),M=(0,r.Pi)(e=>{let{common:t,tabIndex:i,blockIndex:r}=e,{ref:c,intersectionPropertyId:d}=p({id:t.id,tabIndex:i,blockIndex:r}),{from:x}=(0,l.MhG)(),y=(0,s.useMemo)(()=>t.tracks.map((e,s)=>{let o={contextData:{type:v.A.Various,meta:{id:t.contextId},overrideContextType:t.type===n.E.SEARCH?h.Z.Search:h.Z.Other,from:x},queueParams:{index:s},loadContextMeta:!1,entitiesData:t.entitiesData};return(0,a.jsx)(_,{playContextParams:o,type:v.A.Various,track:e,tabIndex:i,blockIndex:r,trackIndex:s},"".concat(e.id,"_").concat(s))}),[t.tracks,t.contextId,t.type,t.entitiesData,x,i,r]),b=(0,s.useMemo)(()=>{switch(t.type){case n.E.OTHER:return(0,a.jsx)(m.Z,{id:"music-history.shuffle"});case n.E.SEARCH:return(0,a.jsx)(m.Z,{id:"music-history.search"})}},[t.type]);return(0,a.jsxs)("section",{className:f().root,ref:c,"data-intersection-property-id":d,children:[(0,a.jsx)(o.Heading,{className:(0,u.W)(f().header,f().heading),variant:"h3",children:b}),(0,a.jsx)("div",{className:f().content,children:y})]})});var E=i(37184);let A=(0,r.Pi)(e=>{var t,i,r,n,c;let{playlist:d,tabIndex:x,blockIndex:b}=e,{ref:S,intersectionPropertyId:g}=p({id:d.id,tabIndex:x,blockIndex:b}),{from:k}=(0,l.MhG)({blockId:d.isLoaded?"playlist-".concat(null===(t=d.meta)||void 0===t?void 0:t.id):""}),{formatMessage:j}=(0,E.Z)(),I=(0,s.useMemo)(()=>{var e,t,i,r;return d.isShimmerVisible?(0,a.jsx)(y.XM,{isActive:d.isShimmerActive,className:f().header,withDescription:!0}):(0,a.jsx)(y.ti,{className:f().header,titleSize:"xs",titleLineClamp:1,coverUrl:null===(e=d.meta)||void 0===e?void 0:e.coverUri,title:null===(t=d.meta)||void 0===t?void 0:t.title,titleClassName:f().headerTitle,description:j({id:"entity-names.number-of-tracks"},{counter:null===(i=d.meta)||void 0===i?void 0:i.tracksCount}),fallbackIconVariant:"playlist",withCover:!0,viewAllActionLink:"/playlists/".concat(null===(r=d.meta)||void 0===r?void 0:r.uuid),headingVariant:"h4",withDescription:!0})},[j,d.isShimmerActive,d.isShimmerVisible,null===(i=d.meta)||void 0===i?void 0:i.coverUri,null===(r=d.meta)||void 0===r?void 0:r.title,null===(n=d.meta)||void 0===n?void 0:n.tracksCount,null===(c=d.meta)||void 0===c?void 0:c.uuid]),M=(0,s.useMemo)(()=>d.tracks.map((e,t)=>{let i={contextData:{type:v.A.Various,meta:{id:d.contextId},from:k,overrideAutoflowSeeds:d.autoflowSeeds,overrideContextType:h.Z.Playlist},queueParams:{index:t},loadContextMeta:!1,entitiesData:d.entitiesData};return(0,a.jsx)(_,{playContextParams:i,type:v.A.Playlist,track:e,tabIndex:x,blockIndex:b,trackIndex:t},"".concat(e.id,"_").concat(t))}),[d.tracks,d.contextId,d.autoflowSeeds,d.entitiesData,k,x,b]);return(0,a.jsxs)("section",{className:f().root,ref:S,"data-intersection-property-id":g,children:[(0,a.jsx)(o.Heading,{className:(0,u.W)(f().header,f().heading),variant:"h3",children:(0,a.jsx)(m.Z,{id:"music-history.playlist"})}),I,(0,a.jsx)("div",{className:f().content,children:M})]})}),C=(0,r.Pi)(e=>{var t,i,r,n;let{vibe:c,blockIndex:d,tabIndex:x}=e,{ref:b,intersectionPropertyId:S}=p({id:c.id,blockIndex:d,tabIndex:x}),{from:g}=(0,l.MhG)({blockId:"wave-".concat(c.id)}),k=(0,s.useMemo)(()=>{var e,t,i,r,s;return c.isShimmerVisible?(0,a.jsx)(y.XM,{isActive:c.isShimmerActive,className:f().header,coverRadius:"round"}):(0,a.jsx)(y.ti,{titleSize:"xs",titleLineClamp:1,className:f().header,coverUrl:null===(e=c.meta)||void 0===e?void 0:e.imageUrl,title:null!==(s=null===(t=c.meta)||void 0===t?void 0:t.title)&&void 0!==s?s:null===(i=c.meta)||void 0===i?void 0:i.header,titleClassName:f().headerTitle,coverBackgroundColor:null===(r=c.meta)||void 0===r?void 0:r.backgroundColor,coverRadius:"round",headingVariant:"h4"})},[c.isShimmerActive,c.isShimmerVisible,null===(t=c.meta)||void 0===t?void 0:t.backgroundColor,null===(i=c.meta)||void 0===i?void 0:i.header,null===(r=c.meta)||void 0===r?void 0:r.imageUrl,null===(n=c.meta)||void 0===n?void 0:n.title]),j=(0,s.useMemo)(()=>c.tracks.map((e,t)=>{let i={contextData:{type:v.A.Various,meta:{id:c.contextId},overrideAutoflowSeeds:c.autoflowSeeds,overrideContextType:h.Z.Radio,from:g},queueParams:{index:t},loadContextMeta:!1,entitiesData:c.entitiesData};return(0,a.jsx)(_,{playContextParams:i,type:v.A.Vibe,track:e,blockIndex:d,tabIndex:x,trackIndex:t},"".concat(e.id,"_").concat(t))}),[c.tracks,c.contextId,c.autoflowSeeds,c.entitiesData,g,d,x]);return(0,a.jsxs)("section",{className:f().root,ref:b,"data-intersection-property-id":S,children:[(0,a.jsx)(o.Heading,{className:(0,u.W)(f().header,f().heading),variant:"h3",children:(0,a.jsx)(m.Z,{id:"music-history.my-vibe"})}),k,(0,a.jsx)("div",{className:f().content,children:j})]})});var V=i(73584),H=i.n(V);let L=(0,r.Pi)(e=>{let{tab:t,tabIndex:i,onTabShowOrHide:r,shouldHideInactiveTab:u,...m}=e,{musicHistory:v}=(0,l.oR4)(),h=(0,s.useMemo)(()=>{var e;return null===(e=t.blocks)||void 0===e?void 0:e.map((e,t)=>{switch(e.type){case n.E.ALBUM:return(0,a.jsx)(j,{album:e,blockIndex:t,tabIndex:i},"".concat(e.key,"_").concat(t));case n.E.PLAYLIST:return(0,a.jsx)(A,{playlist:e,blockIndex:t,tabIndex:i},"".concat(e.key,"_").concat(t));case n.E.WAVE:return(0,a.jsx)(C,{vibe:e,blockIndex:t,tabIndex:i},"".concat(e.key,"_").concat(t));case n.E.ARTIST:return(0,a.jsx)(I,{artist:e,blockIndex:t,tabIndex:i},"".concat(e.key,"_").concat(t));case n.E.SEARCH:case n.E.OTHER:return(0,a.jsx)(M,{common:e,blockIndex:t,tabIndex:i},"".concat(e.key,"_").concat(t));default:return null}}).filter(e=>e)},[t.blocks,i]),x=(0,d.useFormatDate)(),y=(0,s.useRef)(null),{observeElement:p}=(0,s.useContext)(c.MusicHistoryIntersectionObserverContext),b=v.datesMap.get(t.date);return(0,s.useEffect)(()=>{p({elementId:t.date,elementRef:y,index:0,onShow:()=>{v.setDatesMap(t.date,!0),r()},onHide:()=>{v.setDatesMap(t.date,!1),r()}})},[v,v.datesMap,p,r,t.date]),(0,a.jsxs)("div",{"aria-hidden":!b&&u,ref:y,"data-intersection-property-id":t.date,className:H().root,...m,inert:!b&&u?"":void 0,children:[(0,a.jsx)(o.Heading,{"data-date-anchor":t.date,className:H().date,variant:"h2",size:"m",children:x(t.date)}),(0,a.jsx)("div",{className:H().content,children:h})]})})},59058:function(e){e.exports={root:"MusicHistoryPage_root__FYB2m",scroll:"MusicHistoryPage_scroll__ykpDX",scrollContainer:"MusicHistoryPage_scrollContainer__eemvg",headerContainer:"MusicHistoryPage_headerContainer__QG0L3",header:"MusicHistoryPage_header__dzEvD",content:"MusicHistoryPage_content__j4evw",footer:"MusicHistoryPage_footer__Vu7aC",empty:"MusicHistoryPage_empty__fQRHA",carousel:"MusicHistoryPage_carousel__jcl8l",tabs:"MusicHistoryPage_tabs__v_5Zg",tab:"MusicHistoryPage_tab__WDE1e",tab_selected:"MusicHistoryPage_tab_selected__nmn8P",tab_isLoading:"MusicHistoryPage_tab_isLoading__nNqd2",date:"MusicHistoryPage_date__OV6rR",error:"MusicHistoryPage_error__9f_8i",important:"MusicHistoryPage_important__qNFO8"}},56403:function(e){e.exports={shimmersContainer:"MusicHistoryPageContentShimmer_shimmersContainer__82cj6",dateShimmer:"MusicHistoryPageContentShimmer_dateShimmer__d4_te",contextNameShimmer:"MusicHistoryPageContentShimmer_contextNameShimmer__Tzbqr",contextHeaderShimmer:"MusicHistoryPageContentShimmer_contextHeaderShimmer__Tq0PZ",trackListShimmers:"MusicHistoryPageContentShimmer_trackListShimmers__4GSp8"}},73584:function(e){e.exports={date:"MusicHistoryTab_date__Fjy3P",content:"MusicHistoryTab_content__Jt15j"}},55913:function(e){e.exports={trackShimmer:"MusicHistoryTrack_trackShimmer__yxcx9"}},83141:function(e){e.exports={header:"MusicHistoryBlock_header__sIFVC",heading:"MusicHistoryBlock_heading__HEfmk",headerTitle:"MusicHistoryBlock_headerTitle__Yhyst",content:"MusicHistoryBlock_content__S9lfi",artists:"MusicHistoryBlock_artists__AjuWP",artistLink:"MusicHistoryBlock_artistLink__yFHPE",shimmerTitle:"MusicHistoryBlock_shimmerTitle__Mx1IC"}},9973:function(e,t,i){"use strict";var a,r;i.d(t,{E:function(){return a}}),(r=a||(a={})).TRACK="track",r.WAVE="wave",r.ARTIST="artist",r.PLAYLIST="playlist",r.ALBUM="album",r.OTHER="other",r.SEARCH="search"}}]);